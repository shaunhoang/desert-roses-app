<<<<<<< Updated upstream
{"title":"Project Desert Rose - Identifying desertification risk areas in Niger","markdown":{"yaml":{"title":"Project Desert Rose - Identifying desertification risk areas in Niger"},"headingText":"Project Summary","containsRefs":false,"markdown":"\n\n![](images/clipboard-3098452386.png){fig-align=\"center\"}\n\n\n### Problem Statement\n\nNiger, a landlocked country in Africa's Sahel region, faces rising temperatures, low rainfall and a decrease in arable land, indicative of desertification. The shrinking land and water sources pose food and water security threats, risking humanitarian crises and conflicts. Initiatives like Action Against Desertification (FAO-UN) and regional projects (FLEUVE, BRICKS) aim to restore degraded land and push back the desert.\n\nHowever, as each task force operates independently, the nation lacks centralised visibility on desertification risks to mobilise the GGW action plan with urgency and prioritise resources systematically across diverse actors.\n\n### End User\n\nThis application is meant for the local government, NGOs and the different organisations involved in the Great Green Wall initiative so that there is a centralised platform where they can visualise to what extent desertification affects Niger people at high spatial resolution.\n\nFuture extensions of the tool include highlighting specific areas within the designated Great Green Wall path that are most suitable for planting trees and soil-enriching crops, making the insights more actionable for the implementing task forces and farmers nationwide.\n\n### Data Source\n\nTo derive the *Desertification Index (*detailed methodology below), we used *Landsat 8 OLI data (2013-present)* for hyperspectral remote sensing data containing all the necessary spectral bands. Furthermore, to quantify the affected population, we used the *WorldPop global population raster data at 100m resolution (2000-2020*). Finally, to delineate the boundaries of interest, we will use *Niger Administrative Boundaries, Level 0 through 2.*\n\n### Methodology\n\nAccording to Wu et al. (2019), the Desertification Risk Index (DRI), which we have extracted from their Desert Matter Index (DMI), can be calculated using Landsat-8 remote sensing data, from which Albedo and Modified Soil Adjusted Vegetation Index (MSAVI) were calculated. Furthermore, Yang et al (2022) identify that the combined albedo-MSAVI formula is most optimal for identifying desertification in the Sahel region.\n\n#### Albedo\n\nAlbedo is a measure of the reflectivity of the Earth's surface, ranging from 0 (no reflectivity) to 1 (total reflectivity). It helps in understanding the Earth's energy balance as it indicates how much solar radiation is absorbed versus reflected back into space (Yale, n.d.). The formula for albedo, particularly using Landsat data (as the calculation can vary based on sensor and land type), involves a weighted combination of spectral bands B2 (Blue), B4 (Red), B5 (NIR), B6 (SWIR1), B7 (SWIR2); these represent different portions of the electromagnetic spectrum (Wu et al., 2019):\n\n$$ Albedo = 0.356B_{blue} + 0.13B_{red} + 0.373B_{nir} + 0.085B_{swir1} + 0.072B_{swir2} - 0.0018 $$\n\nHigh albedo values correlate with highly reflective surfaces (such as flat desert or snow terrains); low values correlate with poorly reflecting surfaces (such as dense forestation).\n\n| [Higher albedo]{.underline}, in this context, indicates [higher levels of desertification]{.underline}.\n\n#### Modified Soil Adjusted Vegetation Index\n\nThe MSAVI is designed to minimise the impact of soil brightness when vegetation is sparse, providing a more accurate vegetation signal. This index is particularly useful in semi-arid regions, such as Niger, where exposed soil can significantly affect the standard vegetation indices like NDVI. It ranges from -1 (non-vegetated areas or sparse vegetation) to 1 (higher levels of vegetation and vegetation health). The formula for MSAVI is:\n\n$$ MSAVI = \\frac{2B_{nir} + 1 - \\sqrt{(2B_{nir} + 1)^2 - 8(B_{nir}-B_{red})}}2 $$\n\nThis index uses a quadratic function to reduce the influence of soil background by adjusting the red (B3) and near-infrared (B4) band values. The incorporation of an \"inductive L function\" in this formula helps to maximise the reduction of soil effects, enhancing the robustness of vegetation monitoring (USGS: Landsat Missions, n.d.; Wu et al., 2019).\n\nWe then adapt this by adding 1 to the value and dividing by 2 -- this shifts values to the 0 to 2 range and then standardises to them to the 0 to 1 range (same as albedo).\n\n| [Higher MSAVI]{.underline}, in this context, indicates [lower levels of desertification]{.underline}.\n\n#### Desertification Risk Index (DRI)\n\nThe DRI integrates the albedo and MSAVI to assess areas at risk of desertification (adapted from Wu et al., 2019; and Yang et al., 2022). Its composite score effectively synthesises information on both vegetation health and surface reflectivity into a single metric. Due to the opposite direction of each indicator correlating with higher levels of desertification, they need to be transformed so that they are in the same direction, before being weighed and aggregated. As such the formula for DRI is:\n\n$$ DRI = L_1 = \\sqrt{(MSAVI-1)^2 + Albedo^2} $$\n\nThis formula produces values where a higher DRI indicates greater risk of desertification. The use of Euclidean distance in this formula combines the deviations of MSAVI and albedo from their norms, providing a measure that is sensitive to changes in both vegetation cover and surface reflectivity.\n\n![A larger DRI means more degraded soil and higher desertification risk.](images/clipboard-449413320.png){fig-align=\"center\"}\n\nIt is worth noting that this methodology has shown relatively high accuracy in detecting and classifying desertification in the Naiman Banner in Inner Mongolia (China) but not specifically in the Southern Sahel where Niger is located. However, thanks to the fact that the two areas share similar characteristics in terms of wetness and vegetation, we see the application of this methodology as appropriate for the Southern Sahel region.\n\n### Interface\n\nFirst, the user picks the *year of interest* using a slider. This will produce populated areas with high desertification risks. To acquire statistics on the extent of human impact, the user can choose a *region of interest* from the drop-down menu or draw the area of interest using the tool provided, to know the population share that lives on degraded land.\n\n# The Application\n\n::: column-page\n<iframe src=\"https://ee-shaunhoang.projects.earthengine.app/view/project-desert-rose\" width=\"130%\" height=\"600px\">\n\n</iframe>\n:::\n\n# How it Works\n\n### Calculating Desertification Risk Index from Land-8 dataset\n\nExplain the DRI calculation + the transformation we made to normalise the indices...\n\n``` js\nMap.setCenter(35.51898, 33.90153, 15);\n\nMap.setOptions(\"satellite\");\n\nvar aoi = ee.Geometry.Point(35.51898, 33.90153).buffer(3000);\n```\n\n### Estimating the affected population using the WorldPop dataset\n\nExplain the code to mask DRI layer + Population to identify high-risk populated areas to produce stats\n\n### User Interface\n\nUse this section to explain interactive components:\n\n-   Split panels\n\n-   Dropdown menu\n\n-   Draw polygons\n\n``` js\nMap.setCenter(35.51898, 33.90153, 15);  Map.setOptions(\"satellite\");  var aoi = ee.Geometry.Point(35.51898, 33.90153).buffer(3000);\n```\n\nYou can include images:\n\n![](images/Screenshot%202024-04-19%20205034.png){fig-align=\"center\"}\n\n# References\n\nUSGS: Landsat Missions (n.d.). Landsat Modified Soil Adjusted Vegetation Index \\| U.S. Geological Survey. \\[online\\] www.usgs.gov. Available at: https://www.usgs.gov/landsat-missions/landsat-modified-soil-adjusted-vegetation-index \\[Accessed 21 Apr. 2024\\].\n\nYale (n.d.). How to convert Landsat DNs to albedo \\| Center for Earth Observation. \\[online\\] Center for Earth Observation. Available at: https://yceo.yale.edu/how-convert-landsat-dns-albedo \\[Accessed 21 Apr. 2024\\].\n\nYang, Z., Gao, X., Lei, J., Meng, X. and Zhou, N. (2022). Analysis of spatiotemporal changes and driving factors of desertification in the Africa Sahel. CATENA, 213, p.106213. doi:https://doi.org/10.1016/j.catena.2022.106213.\n\nWen, Ye & Guo, Bing & Zang, Wenqian & Ge, Dazhuan & Luo, Wei & Zhao, Huihui. (2020). Desertification detection model in Naiman Banner based on the albedo-modified soil adjusted vegetation index feature space using the Landsat8 OLI images. Geomatics, Natural Hazards and Risk. 11. 544-558. 10.1080/19475705.2020.1734100.\n\nWu, Z., Lei, S., Bian, Z. *et al.* Study of the desertification index based on the albedo-MSAVI feature space for semi-arid steppe region. *Environ Earth Sci* 78, 232 (2019). https://doi.org/10.1007/s12665-019-8111-9\n","srcMarkdownNoYaml":"\n\n![](images/clipboard-3098452386.png){fig-align=\"center\"}\n\n# Project Summary\n\n### Problem Statement\n\nNiger, a landlocked country in Africa's Sahel region, faces rising temperatures, low rainfall and a decrease in arable land, indicative of desertification. The shrinking land and water sources pose food and water security threats, risking humanitarian crises and conflicts. Initiatives like Action Against Desertification (FAO-UN) and regional projects (FLEUVE, BRICKS) aim to restore degraded land and push back the desert.\n\nHowever, as each task force operates independently, the nation lacks centralised visibility on desertification risks to mobilise the GGW action plan with urgency and prioritise resources systematically across diverse actors.\n\n### End User\n\nThis application is meant for the local government, NGOs and the different organisations involved in the Great Green Wall initiative so that there is a centralised platform where they can visualise to what extent desertification affects Niger people at high spatial resolution.\n\nFuture extensions of the tool include highlighting specific areas within the designated Great Green Wall path that are most suitable for planting trees and soil-enriching crops, making the insights more actionable for the implementing task forces and farmers nationwide.\n\n### Data Source\n\nTo derive the *Desertification Index (*detailed methodology below), we used *Landsat 8 OLI data (2013-present)* for hyperspectral remote sensing data containing all the necessary spectral bands. Furthermore, to quantify the affected population, we used the *WorldPop global population raster data at 100m resolution (2000-2020*). Finally, to delineate the boundaries of interest, we will use *Niger Administrative Boundaries, Level 0 through 2.*\n\n### Methodology\n\nAccording to Wu et al. (2019), the Desertification Risk Index (DRI), which we have extracted from their Desert Matter Index (DMI), can be calculated using Landsat-8 remote sensing data, from which Albedo and Modified Soil Adjusted Vegetation Index (MSAVI) were calculated. Furthermore, Yang et al (2022) identify that the combined albedo-MSAVI formula is most optimal for identifying desertification in the Sahel region.\n\n#### Albedo\n\nAlbedo is a measure of the reflectivity of the Earth's surface, ranging from 0 (no reflectivity) to 1 (total reflectivity). It helps in understanding the Earth's energy balance as it indicates how much solar radiation is absorbed versus reflected back into space (Yale, n.d.). The formula for albedo, particularly using Landsat data (as the calculation can vary based on sensor and land type), involves a weighted combination of spectral bands B2 (Blue), B4 (Red), B5 (NIR), B6 (SWIR1), B7 (SWIR2); these represent different portions of the electromagnetic spectrum (Wu et al., 2019):\n\n$$ Albedo = 0.356B_{blue} + 0.13B_{red} + 0.373B_{nir} + 0.085B_{swir1} + 0.072B_{swir2} - 0.0018 $$\n\nHigh albedo values correlate with highly reflective surfaces (such as flat desert or snow terrains); low values correlate with poorly reflecting surfaces (such as dense forestation).\n\n| [Higher albedo]{.underline}, in this context, indicates [higher levels of desertification]{.underline}.\n\n#### Modified Soil Adjusted Vegetation Index\n\nThe MSAVI is designed to minimise the impact of soil brightness when vegetation is sparse, providing a more accurate vegetation signal. This index is particularly useful in semi-arid regions, such as Niger, where exposed soil can significantly affect the standard vegetation indices like NDVI. It ranges from -1 (non-vegetated areas or sparse vegetation) to 1 (higher levels of vegetation and vegetation health). The formula for MSAVI is:\n\n$$ MSAVI = \\frac{2B_{nir} + 1 - \\sqrt{(2B_{nir} + 1)^2 - 8(B_{nir}-B_{red})}}2 $$\n\nThis index uses a quadratic function to reduce the influence of soil background by adjusting the red (B3) and near-infrared (B4) band values. The incorporation of an \"inductive L function\" in this formula helps to maximise the reduction of soil effects, enhancing the robustness of vegetation monitoring (USGS: Landsat Missions, n.d.; Wu et al., 2019).\n\nWe then adapt this by adding 1 to the value and dividing by 2 -- this shifts values to the 0 to 2 range and then standardises to them to the 0 to 1 range (same as albedo).\n\n| [Higher MSAVI]{.underline}, in this context, indicates [lower levels of desertification]{.underline}.\n\n#### Desertification Risk Index (DRI)\n\nThe DRI integrates the albedo and MSAVI to assess areas at risk of desertification (adapted from Wu et al., 2019; and Yang et al., 2022). Its composite score effectively synthesises information on both vegetation health and surface reflectivity into a single metric. Due to the opposite direction of each indicator correlating with higher levels of desertification, they need to be transformed so that they are in the same direction, before being weighed and aggregated. As such the formula for DRI is:\n\n$$ DRI = L_1 = \\sqrt{(MSAVI-1)^2 + Albedo^2} $$\n\nThis formula produces values where a higher DRI indicates greater risk of desertification. The use of Euclidean distance in this formula combines the deviations of MSAVI and albedo from their norms, providing a measure that is sensitive to changes in both vegetation cover and surface reflectivity.\n\n![A larger DRI means more degraded soil and higher desertification risk.](images/clipboard-449413320.png){fig-align=\"center\"}\n\nIt is worth noting that this methodology has shown relatively high accuracy in detecting and classifying desertification in the Naiman Banner in Inner Mongolia (China) but not specifically in the Southern Sahel where Niger is located. However, thanks to the fact that the two areas share similar characteristics in terms of wetness and vegetation, we see the application of this methodology as appropriate for the Southern Sahel region.\n\n### Interface\n\nFirst, the user picks the *year of interest* using a slider. This will produce populated areas with high desertification risks. To acquire statistics on the extent of human impact, the user can choose a *region of interest* from the drop-down menu or draw the area of interest using the tool provided, to know the population share that lives on degraded land.\n\n# The Application\n\n::: column-page\n<iframe src=\"https://ee-shaunhoang.projects.earthengine.app/view/project-desert-rose\" width=\"130%\" height=\"600px\">\n\n</iframe>\n:::\n\n# How it Works\n\n### Calculating Desertification Risk Index from Land-8 dataset\n\nExplain the DRI calculation + the transformation we made to normalise the indices...\n\n``` js\nMap.setCenter(35.51898, 33.90153, 15);\n\nMap.setOptions(\"satellite\");\n\nvar aoi = ee.Geometry.Point(35.51898, 33.90153).buffer(3000);\n```\n\n### Estimating the affected population using the WorldPop dataset\n\nExplain the code to mask DRI layer + Population to identify high-risk populated areas to produce stats\n\n### User Interface\n\nUse this section to explain interactive components:\n\n-   Split panels\n\n-   Dropdown menu\n\n-   Draw polygons\n\n``` js\nMap.setCenter(35.51898, 33.90153, 15);  Map.setOptions(\"satellite\");  var aoi = ee.Geometry.Point(35.51898, 33.90153).buffer(3000);\n```\n\nYou can include images:\n\n![](images/Screenshot%202024-04-19%20205034.png){fig-align=\"center\"}\n\n# References\n\nUSGS: Landsat Missions (n.d.). Landsat Modified Soil Adjusted Vegetation Index \\| U.S. Geological Survey. \\[online\\] www.usgs.gov. Available at: https://www.usgs.gov/landsat-missions/landsat-modified-soil-adjusted-vegetation-index \\[Accessed 21 Apr. 2024\\].\n\nYale (n.d.). How to convert Landsat DNs to albedo \\| Center for Earth Observation. \\[online\\] Center for Earth Observation. Available at: https://yceo.yale.edu/how-convert-landsat-dns-albedo \\[Accessed 21 Apr. 2024\\].\n\nYang, Z., Gao, X., Lei, J., Meng, X. and Zhou, N. (2022). Analysis of spatiotemporal changes and driving factors of desertification in the Africa Sahel. CATENA, 213, p.106213. doi:https://doi.org/10.1016/j.catena.2022.106213.\n\nWen, Ye & Guo, Bing & Zang, Wenqian & Ge, Dazhuan & Luo, Wei & Zhao, Huihui. (2020). Desertification detection model in Naiman Banner based on the albedo-modified soil adjusted vegetation index feature space using the Landsat8 OLI images. Geomatics, Natural Hazards and Risk. 11. 544-558. 10.1080/19475705.2020.1734100.\n\nWu, Z., Lei, S., Bian, Z. *et al.* Study of the desertification index based on the albedo-MSAVI feature space for semi-arid steppe region. *Environ Earth Sci* 78, 232 (2019). https://doi.org/10.1007/s12665-019-8111-9\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"monokai.theme","output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","book":{"title":"CASA0025 Final Assessment","author":"MASH Potatoes - Desert Rose","date":"22/04/2024","chapters":["index.qmd"],"favicon":"images/circl-logo.png"},"theme":{"light":"cosmo","dark":"darkly"},"code-copy":true,"linkcolor":"#34a832","title":"Project Desert Rose - Identifying desertification risk areas in Niger"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
=======
{"title":"Project Desert Rose - Identifying desertification risk areas in Niger","markdown":{"yaml":{"title":"Project Desert Rose - Identifying desertification risk areas in Niger"},"headingText":"Project Summary","containsRefs":false,"markdown":"\n\n![](images/clipboard-3098452386.png){fig-align=\"center\"}\n\n\n### Problem Statement\n\nNiger, a landlocked country in Africa’s Sahel region, faces rising temperatures, low rainfall and a decrease in arable land, indicative of desertification. The shrinking land and water sources pose food and water security threats, risking humanitarian crises and conflicts. Initiatives like Action Against Desertification (FAO-UN) and regional projects (FLEUVE, BRICKS) aim to restore degraded land and push back the desert.\n\nHowever, as each task force operates independently, the nation lacks centralised visibility on nationwide desertification risks, making it difficult to mobilise the action plan with urgency and prioritise resources across diverse actors to the communities most in need.\n\n### End User\n\nThis application is meant for the local government, NGOs and different organisations so that there is a centralised platform where they can visualise to what extent desertification affects Niger people at high spatial resolution and which areas are seeing desertification worsen over the past decade.\n\n### Data Source\n\nThree remote sensing Google Earth Engine data sets are used:\n\n-   To derive the *Desertification Risk Index (*detailed methodology below), we used *Landsat 8 OLI* hyperspectral remote sensing data (*2014-2023)* containing all the necessary spectral bands for index calculation.\n\n-   To quantify the affected population, we used the *WorldPop global population raster data at 100m resolution (2000-2020*).\n\n-   Finally, to delineate the boundaries of interest, we will use *Niger Administrative Boundaries, Level 0 and Level 1.*\n\n### Methodology\n\nAccording to Wu et al. (2019) and Wen et al. (2020), the Desertification Risk Index (DRI) can be calculated using Landsat 8 remote sensing data, from which Albedo and Modified Soil Adjusted Vegetation Index (MSAVI) were derived.\n\n$$ Albedo = 0.356B_{blue} + 0.13B_{red} + 0.373B_{nir} + 0.085B_{swir1} + 0.072B_{swir2} - 0.0018 $$\n\n$$ MSAVI = \\frac{2B_{nir} + 1 - \\sqrt{(2B_{nir} + 1)^2 - 8(B_{nir}-B_{red})}}2 $$\n\nThe Desertification Risk Index (DRI) is then defined as:\n\n$$ DRI = L_1 = \\sqrt{(MSAVI-1)^2 + Albedo^2} $$\n\n![A larger DRI means more degraded soil and higher desertification risk.](images/clipboard-449413320.png){fig-align=\"center\"}\n\nIt is worth noting that this methodology has shown relatively high accuracy in detecting and classifying desertification in the Naiman Banner in Inner Mongolia (China) but not specifically in the Southern Sahel where Niger is located. However, thanks to the fact that the two areas share similar characteristics in terms of wetness and vegetation, we see the application of this methodology as appropriate for the Southern Sahel region.\n\n### Interface\n\nThe user can select the *year of interest* and then the *area of interest* to produce various map layers and statistics:\n\n-   By default, the map of high-risk areas will be shown, indicating the desertification level only in populated areas, excluding uninhabited lands such as the inner section of the Sahara Desert to the north.\n\n-   When a region is selected, or an area of interest is drawn, statistics on the average DRI value and the percentage of the affected population will be shown. The user can redraw the area or reset the map anytime.\n\nFinally, other layers of interest are (1) Population density in high-risk areas, (2) DRI nationwide in the year of choice, and (3) Change in DRI nationwide 2014-2023.\n\n# The Application\n\n::: column-page\n<iframe src=\"https://ee-shaunhoang.projects.earthengine.app/view/project-desert-rose\" width=\"125%\" height=\"500px\">\n\n</iframe>\n:::\n\n# How it Works\n\n### Calculating Desertification Risk Index from Land-8 dataset\n\n(Aaron)\n\nFirst,\n\n``` javascript\n// Load country boundaries\nvar niger = ee.FeatureCollection(\"FAO/GAUL/2015/level0\").filter(ee.Filter.eq('ADM0_CODE', 181));\nvar niger_1 = ee.FeatureCollection(\"FAO/GAUL/2015/level1\").filter(ee.Filter.eq('ADM0_CODE', 181));\nvar nigerGeometry = niger.geometry(); // Convert niger to a geometry for clipping.\nMap.centerObject(niger, 5); // Center the map over Niger\nMap.setOptions('HYBRID')\n\n// Load and filter collection for time period, extent, indices and cloud cover,\nvar composite = ee.ImageCollection('LANDSAT/LC08/C02/T1_L2')\n              .filterDate('2014-01-01','2023-12-31')\n              .filterBounds(niger)\n              .select(['SR_B[0-9]*'])\n              ;\n```\n\n``` js\n// Function to calculate DRI\nvar calculateIndices = function(image){\n  // Calculate MSAVI\n  var msavi = image.expression(\n    '(((2 * B5 + 1 - sqrt((2 * B5 + 1)**2 - 8 * (B5 - B4))) / 2) +1)/2', {\n      'B5': image.select('SR_B5'), // NIR\n      'B4': image.select('SR_B4')  // Red\n    }).rename('msavi');\n    // MSAVI is the Modified Soil Adjusted Vegetation Index; minimizes the effect of bare soil on the SAVI. Refer to Yang et al (2022).\n    // This equation modifies the typical equation to account for the typical MSAVI range being -1:1; this adapts it to 0:1 by adding 1 to the value and dividing by 2. \n  \n  // Calculate Albedo\n  var albedo = image.expression(\n    '((0.356*B2) + (0.130*B4) + (0.373*B5) + (0.085*B6) + (0.072*B7) - 0.0018)*0.0000275 - 0.2', {\n      'B2': image.select('SR_B2'), // Blue\n      'B4': image.select('SR_B4'), // Red\n      'B5': image.select('SR_B5'), // NIR\n      'B6': image.select('SR_B6'), // SWIR1\n      'B7': image.select('SR_B7')  // SWIR2\n    }).rename('albedo');\n    // ALbedo gives the proportion of the incident light or radiation that is reflected by a surface. Refer to Yang et al (2022).\n\n  // Calculate DRI\n  var dri = image.expression(\n    'sqrt( (MSAVI - 1)**2 + (Albedo)**2 )', {\n      'MSAVI': msavi, // Use the MSAVI band calculated previously\n      'Albedo': albedo // Use the Albedo band calculated previously\n    }).rename('DRI');\n    // DRI formula extracted from Wen et al (2020) and adapted slightly; uses DMI formula\n    \n  // Return the image with added DRI band\n  return image.addBands([dri, msavi, albedo]).clip(nigerGeometry);\n};\n```\n\nLoad data\n\n``` js\n\n              \n// Simplify collection to years (median) and calculate indices \nvar distinctYears = ee.List.sequence(2014, 2023);\n\nfunction annualComposite(year, month) {\n  var filteredImages = composite.filter(ee.Filter.calendarRange(year, year, 'year'))\n  return filteredImages.median().set({ 'year': year, 'system:time_start': ee.Date.fromYMD(year, 1, 1)} ); \n}\n\nvar composite_annual = ee.ImageCollection.fromImages(\n       distinctYears.map(function(year) {\n         return annualComposite(year);\n       }).flatten()\n).map(calculateIndices);\n\n// Mask images based on DRI values, highlighted high DRI areas only\nfunction maskByDRI(image) {\n  var driMask = image.select('DRI').gte(0.5); \n  return image.updateMask(driMask);\n}\nvar composite_annual_masked = composite_annual.map(maskByDRI);\n```\n\n### Estimating the affected population using the WorldPop dataset\n\nExplain the code to mask DRI layer + Population to identify high-risk populated areas to produce stats\n\n### Statistics and graphs for the year and area of interest\n\nThe left-hand panel allows the user to pick the year of interest via a slider\n\n``` js\n// Create the Year Slider\nvar YearLabel = ui.Label('Year');\nvar Yearslider = ui.Slider({min:2014, \n                            max:2023, \n                            value:2023, \n                            step:1,\n                            onChange: updateLayer\n});\nYearslider.style().set('stretch', 'horizontal');\n\n// Formula to update the layer upon year change\nfunction updateLayer() {\n    var selectedYear = Yearslider.getValue(); // Get the full date object\n    var filteredImage_DRI = composite_annual_masked.select('DRI')\n                          .filter(ee.Filter.eq('year',selectedYear))\n                          .first();\n    var intersectionMask = pop_agesex_masked.first().mask().and(dri_masked.mask()); \n    var intersectionImage = pop_agesex_masked.first().updateMask(intersectionMask);\n  \n  // Update the existing layer every time a new year is chosen\n    Map.layers().set(0, ui.Map.Layer(intersectionImage,{}, 'High-risk areas (Pop. Density) in '+selectedYear,false));\n    Map.layers().set(1, ui.Map.Layer(intersectionImage_DRI.select('DRI'),driVisParams, 'High-risk areas (DRI) in '+selectedYear));\n    Map.layers().set(2, ui.Map.Layer(filteredImage_DRI.reduce(ee.Reducer.mean()), driVisParams,'Overall Desertification Level in '+selectedYear,false));\n}\n```\n\nThe left-hand panel also enables the user to select an area of interest in one of two ways:\n\n1.  the dropdown menu allows you to click on one of the 8 administrative regions within the country\n\n``` js\n// Extract names\nvar namesList = niger_1.aggregate_array('ADM1_NAME').getInfo();\nnamesList = namesList.filter(function(name){return name !==null && name !==\"\";});\n// Create dropdown \nvar dropdown_menu = ui.Select({\n    items: namesList,\n    placeholder: 'Select a region',\n    onChange: function(selectedName){\n      if(!selectedName){\n        print('No region selected or invalid selection.');\n        return;\n      }\n      var selectedFeature = niger_1.filter(ee.Filter.eq('ADM1_NAME',selectedName));\n          \n      selectedFeature.geometry().evaluate(function(geometry){\n      //zoom to the region\n          Map.centerObject(ee.Geometry(geometry),6.5);\n          //highlight the selected region\n          var region_outline = ee.Image().byte().paint({\n                                featureCollection: selectedFeature,\n                                width: 2,\n                                color: 'purple'\n                                });\n          Map.layers().set(5, ui.Map.Layer(region_outline,{}, 'Region: '+ selectedName));\n      });\n    }\n});\n```\n\n2.  the user can choose to draw a point-based polygon directly onto the map. Enabling this option allows users to zoom into particular areas that are otherwise not distinguishable by region. This is complete with a Clear button to remove the drawn polygon, and a Reset button to reset everything to the initial state.\n\n``` js\n// Add in draw polygon feature\nvar drawingTools = Map.drawingTools();\ndrawingTools.setShown(false);\n\nvar drawButton = ui.Button({\n  label: \"✏️\" + \" Draw an area\",\n  onClick: drawPolygon,\n  style: { stretch: \"horizontal\",color:'F08F42' }\n});\n\nfunction drawPolygon() {\n          // Clear geoms\n          var layers = Map.drawingTools().layers();\n          layers.reset()\n          // draw\n          drawingTools.setShape(\"polygon\");\n          drawingTools.draw();\n}\n\n// Add Clear Geom button\nvar clearButton = ui.Button({\n  label: 'Clear',\n  onClick: clearGeometryAndDisableDrawing\n});\nfunction clearGeometryAndDisableDrawing() {\n  var layers = Map.drawingTools().layers();\n  layers.reset();\n  Map.drawingTools().setShape(null);\n}\n\n// Add Reset button to initial state\nvar resetButton = ui.Button({\n  label: 'Reset',\n  onClick: reset\n});\nfunction reset() {\n  var layerToRemove = Map.layers().get(5)\n  if(layerToRemove){Map.remove(layerToRemove)}\n  dropdown_menu.setValue(null);\n  Map.centerObject(niger, 5);\n  clearGeometryAndDisableDrawing()\n}\n```\n\nOnce an area of interest has been identified, the right-hand panel will generate the relevant stats and graphs related to the desertification index (as shown on the map), population growth, and the percentage of the population that live in desertified land. The example below is the callback function for the dropdown menu, sharing similar callbacks as the drawing tool.\n\n``` js\n// Set a callback function for when the user selects a boundary\ndropdown.widgets().get(1).onChange(function(selectedName){\n  if(!selectedName){\n  print('No region selected or invalid selection.');\n  return;}\n  \n  var selectedBoundary = niger_1.filter(ee.Filter.eq('ADM1_NAME', selectedName));\n  \n  selectedBoundary.geometry().evaluate(function(geometry){\n      //Chart of DRI over time\n      var chart1 = ui.Chart.image.series({\n        imageCollection:composite_annual.select('DRI'),\n        region: ee.Geometry(geometry),\n        reducer: ee.Reducer.mean(),\n        scale: 3000,\n      }).setOptions({\n        title: 'DRI change over time',\n        vAxis:{title: 'DRI'},\n        lineWidth: 1,\n        color: 'E35F27',\n        pointSize: 3,\n      });\n        \n      // Chart of population over time for the selected region.\n      var chart2 = ui.Chart.image.series({\n          imageCollection: pop_masked, \n          region: ee.Geometry(geometry), \n          reducer: ee.Reducer.sum(),\n          scale: 300,\n          xProperty: 'year'\n        }).setSeriesNames(['Pop']) \n          .setOptions({\n          title: 'Population growth in selected area',\n          vAxis: {title: 'Population'},\n          hAxis: {title: 'Year'},\n          lineWidth: 1,\n          pointSize: 3,\n          series: {\n          0: {color: 'orange'} \n          }\n        });\n      \n      // Print the avg DRI value\n      var driValue = composite_annual\n                              .filter(ee.Filter.eq('year',Yearslider.getValue())) // selected year\n                              .median()\n                              .reduceRegion({\n                                            reducer:ee.Reducer.mean(),\n                                            geometry: ee.Geometry(geometry),\n                                            scale: 3000,\n                                            bestEffort: true\n                                            })\n                              .get('DRI');\n      var round_driValue= (ee.Number(driValue).multiply(1000)).round().divide(1000).getInfo()\n      \n      \n      // Print the affected pop value\n      var sum_pop_affected = intersectionImage.reduceRegion({\n        reducer: ee.Reducer.sum(),\n        geometry: ee.Geometry(geometry),\n        scale: 100, // Adjust scale to 100 to fit WorldPop resolution\n        maxPixels: 1e13,\n        bestEffort: true\n      });\n      print('Total population affected:',sum_pop_affected);\n      \n      // Print the pop value\n      var sum_pop = pop_agesex.median().reduceRegion({\n        reducer: ee.Reducer.sum(),\n        geometry: ee.Geometry(geometry),\n        scale: 100, // Adjust scale to 100 to fit WorldPop resolution\n        maxPixels: 1e13,\n        bestEffort: true\n      });\n      print('Total population:',sum_pop);\n      \n      var pct_affected = ee.Number(sum_pop_affected.get('population'))\n                         .divide(ee.Number(sum_pop.get('population')))\n                         .multiply(10000).round() // Round to 2 decimal places\n                         .divide(100); // get %\n      print(pct_affected);\n    \n      \n      // Add/replace widget\n      rightPanel.widgets().set(2,ui.Label('Selected region: '+ selectedName));\n      rightPanel.widgets().set(3,ui.Label('Average DRI in ' + Yearslider.getValue() + ' is ' + round_driValue));\n      rightPanel.widgets().set(4,ui.Label(pct_affected.getInfo() + '% of the population in '+selectedName+ ' live on highly degraded land (DRI > 0.5)'));\n      rightPanel.widgets().set(5,chart1);\n      rightPanel.widgets().set(6,chart2);\n  });\n});\n```\n\nFinally, a legend bar for the DRI is created\n\n``` javascript\n // Color palette to viz params function\nfunction makeColorBarParams(palette) {\n  return {\n    bbox: [0, 0, 1, 0.1],\n    dimensions: \"100x10\",\n    format: \"png\",\n    min: 0,\n    max: 1,\n    palette: palette.reverse(),\n  };\n}\n\n// Create the color bar for the legend.\nvar colorBar = ui.Thumbnail({\n  image: ee.Image.pixelLonLat().select(0),\n  params: makeColorBarParams(colorlist.reverse()),\n  style: { stretch: \"horizontal\", margin: \"0px 2px\", maxHeight: \"18px\" },\n});\n\n// Create title\nvar legendTitle = ui.Label({\n  value: \"Desertification Risk Index (DRI)\",\n  style: { fontWeight: \"bold\" ,textAlign: \"center\",stretch: \"horizontal\"},\n});\n\n// Create labels\nvar legendLabels = ui.Panel({\n  widgets: [\n    ui.Label('Low', { margin: \"4px 4px\" }),\n    ui.Label( \" \", {\n      margin: \"4px 4px\",\n      textAlign: \"center\",\n      stretch: \"horizontal\",\n    }),\n    ui.Label('High', { margin: \"4px 4px\" }),\n  ],\n  layout: ui.Panel.Layout.flow(\"horizontal\"),\n});\n\n// Put everything together and add to map\nvar legendPanel = ui.Panel({\n  widgets: [legendTitle, colorBar, legendLabels],\n  style: { position: \"bottom-center\", width: \"350px\"},\n});\n\nMap.add(legendPanel)\n```\n\n![](images/Screenshot%202024-04-19%20205034.png){fig-align=\"center\"}\n\n# References\n\nWen, Ye & Guo, Bing & Zang, Wenqian & Ge, Dazhuan & Luo, Wei & Zhao, Huihui. (2020). Desertification detection model in Naiman Banner based on the albedo-modified soil adjusted vegetation index feature space using the Landsat8 OLI images. Geomatics, Natural Hazards and Risk. 11. 544-558. 10.1080/19475705.2020.1734100.\n\nWu, Z., Lei, S., Bian, Z. *et al.* Study of the desertification index based on the albedo-MSAVI feature space for semi-arid steppe region. *Environ Earth Sci* 78, 232 (2019). https://doi.org/10.1007/s12665-019-8111-9\n\nYang et al (2022\n","srcMarkdownNoYaml":"\n\n![](images/clipboard-3098452386.png){fig-align=\"center\"}\n\n# Project Summary\n\n### Problem Statement\n\nNiger, a landlocked country in Africa’s Sahel region, faces rising temperatures, low rainfall and a decrease in arable land, indicative of desertification. The shrinking land and water sources pose food and water security threats, risking humanitarian crises and conflicts. Initiatives like Action Against Desertification (FAO-UN) and regional projects (FLEUVE, BRICKS) aim to restore degraded land and push back the desert.\n\nHowever, as each task force operates independently, the nation lacks centralised visibility on nationwide desertification risks, making it difficult to mobilise the action plan with urgency and prioritise resources across diverse actors to the communities most in need.\n\n### End User\n\nThis application is meant for the local government, NGOs and different organisations so that there is a centralised platform where they can visualise to what extent desertification affects Niger people at high spatial resolution and which areas are seeing desertification worsen over the past decade.\n\n### Data Source\n\nThree remote sensing Google Earth Engine data sets are used:\n\n-   To derive the *Desertification Risk Index (*detailed methodology below), we used *Landsat 8 OLI* hyperspectral remote sensing data (*2014-2023)* containing all the necessary spectral bands for index calculation.\n\n-   To quantify the affected population, we used the *WorldPop global population raster data at 100m resolution (2000-2020*).\n\n-   Finally, to delineate the boundaries of interest, we will use *Niger Administrative Boundaries, Level 0 and Level 1.*\n\n### Methodology\n\nAccording to Wu et al. (2019) and Wen et al. (2020), the Desertification Risk Index (DRI) can be calculated using Landsat 8 remote sensing data, from which Albedo and Modified Soil Adjusted Vegetation Index (MSAVI) were derived.\n\n$$ Albedo = 0.356B_{blue} + 0.13B_{red} + 0.373B_{nir} + 0.085B_{swir1} + 0.072B_{swir2} - 0.0018 $$\n\n$$ MSAVI = \\frac{2B_{nir} + 1 - \\sqrt{(2B_{nir} + 1)^2 - 8(B_{nir}-B_{red})}}2 $$\n\nThe Desertification Risk Index (DRI) is then defined as:\n\n$$ DRI = L_1 = \\sqrt{(MSAVI-1)^2 + Albedo^2} $$\n\n![A larger DRI means more degraded soil and higher desertification risk.](images/clipboard-449413320.png){fig-align=\"center\"}\n\nIt is worth noting that this methodology has shown relatively high accuracy in detecting and classifying desertification in the Naiman Banner in Inner Mongolia (China) but not specifically in the Southern Sahel where Niger is located. However, thanks to the fact that the two areas share similar characteristics in terms of wetness and vegetation, we see the application of this methodology as appropriate for the Southern Sahel region.\n\n### Interface\n\nThe user can select the *year of interest* and then the *area of interest* to produce various map layers and statistics:\n\n-   By default, the map of high-risk areas will be shown, indicating the desertification level only in populated areas, excluding uninhabited lands such as the inner section of the Sahara Desert to the north.\n\n-   When a region is selected, or an area of interest is drawn, statistics on the average DRI value and the percentage of the affected population will be shown. The user can redraw the area or reset the map anytime.\n\nFinally, other layers of interest are (1) Population density in high-risk areas, (2) DRI nationwide in the year of choice, and (3) Change in DRI nationwide 2014-2023.\n\n# The Application\n\n::: column-page\n<iframe src=\"https://ee-shaunhoang.projects.earthengine.app/view/project-desert-rose\" width=\"125%\" height=\"500px\">\n\n</iframe>\n:::\n\n# How it Works\n\n### Calculating Desertification Risk Index from Land-8 dataset\n\n(Aaron)\n\nFirst,\n\n``` javascript\n// Load country boundaries\nvar niger = ee.FeatureCollection(\"FAO/GAUL/2015/level0\").filter(ee.Filter.eq('ADM0_CODE', 181));\nvar niger_1 = ee.FeatureCollection(\"FAO/GAUL/2015/level1\").filter(ee.Filter.eq('ADM0_CODE', 181));\nvar nigerGeometry = niger.geometry(); // Convert niger to a geometry for clipping.\nMap.centerObject(niger, 5); // Center the map over Niger\nMap.setOptions('HYBRID')\n\n// Load and filter collection for time period, extent, indices and cloud cover,\nvar composite = ee.ImageCollection('LANDSAT/LC08/C02/T1_L2')\n              .filterDate('2014-01-01','2023-12-31')\n              .filterBounds(niger)\n              .select(['SR_B[0-9]*'])\n              ;\n```\n\n``` js\n// Function to calculate DRI\nvar calculateIndices = function(image){\n  // Calculate MSAVI\n  var msavi = image.expression(\n    '(((2 * B5 + 1 - sqrt((2 * B5 + 1)**2 - 8 * (B5 - B4))) / 2) +1)/2', {\n      'B5': image.select('SR_B5'), // NIR\n      'B4': image.select('SR_B4')  // Red\n    }).rename('msavi');\n    // MSAVI is the Modified Soil Adjusted Vegetation Index; minimizes the effect of bare soil on the SAVI. Refer to Yang et al (2022).\n    // This equation modifies the typical equation to account for the typical MSAVI range being -1:1; this adapts it to 0:1 by adding 1 to the value and dividing by 2. \n  \n  // Calculate Albedo\n  var albedo = image.expression(\n    '((0.356*B2) + (0.130*B4) + (0.373*B5) + (0.085*B6) + (0.072*B7) - 0.0018)*0.0000275 - 0.2', {\n      'B2': image.select('SR_B2'), // Blue\n      'B4': image.select('SR_B4'), // Red\n      'B5': image.select('SR_B5'), // NIR\n      'B6': image.select('SR_B6'), // SWIR1\n      'B7': image.select('SR_B7')  // SWIR2\n    }).rename('albedo');\n    // ALbedo gives the proportion of the incident light or radiation that is reflected by a surface. Refer to Yang et al (2022).\n\n  // Calculate DRI\n  var dri = image.expression(\n    'sqrt( (MSAVI - 1)**2 + (Albedo)**2 )', {\n      'MSAVI': msavi, // Use the MSAVI band calculated previously\n      'Albedo': albedo // Use the Albedo band calculated previously\n    }).rename('DRI');\n    // DRI formula extracted from Wen et al (2020) and adapted slightly; uses DMI formula\n    \n  // Return the image with added DRI band\n  return image.addBands([dri, msavi, albedo]).clip(nigerGeometry);\n};\n```\n\nLoad data\n\n``` js\n\n              \n// Simplify collection to years (median) and calculate indices \nvar distinctYears = ee.List.sequence(2014, 2023);\n\nfunction annualComposite(year, month) {\n  var filteredImages = composite.filter(ee.Filter.calendarRange(year, year, 'year'))\n  return filteredImages.median().set({ 'year': year, 'system:time_start': ee.Date.fromYMD(year, 1, 1)} ); \n}\n\nvar composite_annual = ee.ImageCollection.fromImages(\n       distinctYears.map(function(year) {\n         return annualComposite(year);\n       }).flatten()\n).map(calculateIndices);\n\n// Mask images based on DRI values, highlighted high DRI areas only\nfunction maskByDRI(image) {\n  var driMask = image.select('DRI').gte(0.5); \n  return image.updateMask(driMask);\n}\nvar composite_annual_masked = composite_annual.map(maskByDRI);\n```\n\n### Estimating the affected population using the WorldPop dataset\n\nExplain the code to mask DRI layer + Population to identify high-risk populated areas to produce stats\n\n### Statistics and graphs for the year and area of interest\n\nThe left-hand panel allows the user to pick the year of interest via a slider\n\n``` js\n// Create the Year Slider\nvar YearLabel = ui.Label('Year');\nvar Yearslider = ui.Slider({min:2014, \n                            max:2023, \n                            value:2023, \n                            step:1,\n                            onChange: updateLayer\n});\nYearslider.style().set('stretch', 'horizontal');\n\n// Formula to update the layer upon year change\nfunction updateLayer() {\n    var selectedYear = Yearslider.getValue(); // Get the full date object\n    var filteredImage_DRI = composite_annual_masked.select('DRI')\n                          .filter(ee.Filter.eq('year',selectedYear))\n                          .first();\n    var intersectionMask = pop_agesex_masked.first().mask().and(dri_masked.mask()); \n    var intersectionImage = pop_agesex_masked.first().updateMask(intersectionMask);\n  \n  // Update the existing layer every time a new year is chosen\n    Map.layers().set(0, ui.Map.Layer(intersectionImage,{}, 'High-risk areas (Pop. Density) in '+selectedYear,false));\n    Map.layers().set(1, ui.Map.Layer(intersectionImage_DRI.select('DRI'),driVisParams, 'High-risk areas (DRI) in '+selectedYear));\n    Map.layers().set(2, ui.Map.Layer(filteredImage_DRI.reduce(ee.Reducer.mean()), driVisParams,'Overall Desertification Level in '+selectedYear,false));\n}\n```\n\nThe left-hand panel also enables the user to select an area of interest in one of two ways:\n\n1.  the dropdown menu allows you to click on one of the 8 administrative regions within the country\n\n``` js\n// Extract names\nvar namesList = niger_1.aggregate_array('ADM1_NAME').getInfo();\nnamesList = namesList.filter(function(name){return name !==null && name !==\"\";});\n// Create dropdown \nvar dropdown_menu = ui.Select({\n    items: namesList,\n    placeholder: 'Select a region',\n    onChange: function(selectedName){\n      if(!selectedName){\n        print('No region selected or invalid selection.');\n        return;\n      }\n      var selectedFeature = niger_1.filter(ee.Filter.eq('ADM1_NAME',selectedName));\n          \n      selectedFeature.geometry().evaluate(function(geometry){\n      //zoom to the region\n          Map.centerObject(ee.Geometry(geometry),6.5);\n          //highlight the selected region\n          var region_outline = ee.Image().byte().paint({\n                                featureCollection: selectedFeature,\n                                width: 2,\n                                color: 'purple'\n                                });\n          Map.layers().set(5, ui.Map.Layer(region_outline,{}, 'Region: '+ selectedName));\n      });\n    }\n});\n```\n\n2.  the user can choose to draw a point-based polygon directly onto the map. Enabling this option allows users to zoom into particular areas that are otherwise not distinguishable by region. This is complete with a Clear button to remove the drawn polygon, and a Reset button to reset everything to the initial state.\n\n``` js\n// Add in draw polygon feature\nvar drawingTools = Map.drawingTools();\ndrawingTools.setShown(false);\n\nvar drawButton = ui.Button({\n  label: \"✏️\" + \" Draw an area\",\n  onClick: drawPolygon,\n  style: { stretch: \"horizontal\",color:'F08F42' }\n});\n\nfunction drawPolygon() {\n          // Clear geoms\n          var layers = Map.drawingTools().layers();\n          layers.reset()\n          // draw\n          drawingTools.setShape(\"polygon\");\n          drawingTools.draw();\n}\n\n// Add Clear Geom button\nvar clearButton = ui.Button({\n  label: 'Clear',\n  onClick: clearGeometryAndDisableDrawing\n});\nfunction clearGeometryAndDisableDrawing() {\n  var layers = Map.drawingTools().layers();\n  layers.reset();\n  Map.drawingTools().setShape(null);\n}\n\n// Add Reset button to initial state\nvar resetButton = ui.Button({\n  label: 'Reset',\n  onClick: reset\n});\nfunction reset() {\n  var layerToRemove = Map.layers().get(5)\n  if(layerToRemove){Map.remove(layerToRemove)}\n  dropdown_menu.setValue(null);\n  Map.centerObject(niger, 5);\n  clearGeometryAndDisableDrawing()\n}\n```\n\nOnce an area of interest has been identified, the right-hand panel will generate the relevant stats and graphs related to the desertification index (as shown on the map), population growth, and the percentage of the population that live in desertified land. The example below is the callback function for the dropdown menu, sharing similar callbacks as the drawing tool.\n\n``` js\n// Set a callback function for when the user selects a boundary\ndropdown.widgets().get(1).onChange(function(selectedName){\n  if(!selectedName){\n  print('No region selected or invalid selection.');\n  return;}\n  \n  var selectedBoundary = niger_1.filter(ee.Filter.eq('ADM1_NAME', selectedName));\n  \n  selectedBoundary.geometry().evaluate(function(geometry){\n      //Chart of DRI over time\n      var chart1 = ui.Chart.image.series({\n        imageCollection:composite_annual.select('DRI'),\n        region: ee.Geometry(geometry),\n        reducer: ee.Reducer.mean(),\n        scale: 3000,\n      }).setOptions({\n        title: 'DRI change over time',\n        vAxis:{title: 'DRI'},\n        lineWidth: 1,\n        color: 'E35F27',\n        pointSize: 3,\n      });\n        \n      // Chart of population over time for the selected region.\n      var chart2 = ui.Chart.image.series({\n          imageCollection: pop_masked, \n          region: ee.Geometry(geometry), \n          reducer: ee.Reducer.sum(),\n          scale: 300,\n          xProperty: 'year'\n        }).setSeriesNames(['Pop']) \n          .setOptions({\n          title: 'Population growth in selected area',\n          vAxis: {title: 'Population'},\n          hAxis: {title: 'Year'},\n          lineWidth: 1,\n          pointSize: 3,\n          series: {\n          0: {color: 'orange'} \n          }\n        });\n      \n      // Print the avg DRI value\n      var driValue = composite_annual\n                              .filter(ee.Filter.eq('year',Yearslider.getValue())) // selected year\n                              .median()\n                              .reduceRegion({\n                                            reducer:ee.Reducer.mean(),\n                                            geometry: ee.Geometry(geometry),\n                                            scale: 3000,\n                                            bestEffort: true\n                                            })\n                              .get('DRI');\n      var round_driValue= (ee.Number(driValue).multiply(1000)).round().divide(1000).getInfo()\n      \n      \n      // Print the affected pop value\n      var sum_pop_affected = intersectionImage.reduceRegion({\n        reducer: ee.Reducer.sum(),\n        geometry: ee.Geometry(geometry),\n        scale: 100, // Adjust scale to 100 to fit WorldPop resolution\n        maxPixels: 1e13,\n        bestEffort: true\n      });\n      print('Total population affected:',sum_pop_affected);\n      \n      // Print the pop value\n      var sum_pop = pop_agesex.median().reduceRegion({\n        reducer: ee.Reducer.sum(),\n        geometry: ee.Geometry(geometry),\n        scale: 100, // Adjust scale to 100 to fit WorldPop resolution\n        maxPixels: 1e13,\n        bestEffort: true\n      });\n      print('Total population:',sum_pop);\n      \n      var pct_affected = ee.Number(sum_pop_affected.get('population'))\n                         .divide(ee.Number(sum_pop.get('population')))\n                         .multiply(10000).round() // Round to 2 decimal places\n                         .divide(100); // get %\n      print(pct_affected);\n    \n      \n      // Add/replace widget\n      rightPanel.widgets().set(2,ui.Label('Selected region: '+ selectedName));\n      rightPanel.widgets().set(3,ui.Label('Average DRI in ' + Yearslider.getValue() + ' is ' + round_driValue));\n      rightPanel.widgets().set(4,ui.Label(pct_affected.getInfo() + '% of the population in '+selectedName+ ' live on highly degraded land (DRI > 0.5)'));\n      rightPanel.widgets().set(5,chart1);\n      rightPanel.widgets().set(6,chart2);\n  });\n});\n```\n\nFinally, a legend bar for the DRI is created\n\n``` javascript\n // Color palette to viz params function\nfunction makeColorBarParams(palette) {\n  return {\n    bbox: [0, 0, 1, 0.1],\n    dimensions: \"100x10\",\n    format: \"png\",\n    min: 0,\n    max: 1,\n    palette: palette.reverse(),\n  };\n}\n\n// Create the color bar for the legend.\nvar colorBar = ui.Thumbnail({\n  image: ee.Image.pixelLonLat().select(0),\n  params: makeColorBarParams(colorlist.reverse()),\n  style: { stretch: \"horizontal\", margin: \"0px 2px\", maxHeight: \"18px\" },\n});\n\n// Create title\nvar legendTitle = ui.Label({\n  value: \"Desertification Risk Index (DRI)\",\n  style: { fontWeight: \"bold\" ,textAlign: \"center\",stretch: \"horizontal\"},\n});\n\n// Create labels\nvar legendLabels = ui.Panel({\n  widgets: [\n    ui.Label('Low', { margin: \"4px 4px\" }),\n    ui.Label( \" \", {\n      margin: \"4px 4px\",\n      textAlign: \"center\",\n      stretch: \"horizontal\",\n    }),\n    ui.Label('High', { margin: \"4px 4px\" }),\n  ],\n  layout: ui.Panel.Layout.flow(\"horizontal\"),\n});\n\n// Put everything together and add to map\nvar legendPanel = ui.Panel({\n  widgets: [legendTitle, colorBar, legendLabels],\n  style: { position: \"bottom-center\", width: \"350px\"},\n});\n\nMap.add(legendPanel)\n```\n\n![](images/Screenshot%202024-04-19%20205034.png){fig-align=\"center\"}\n\n# References\n\nWen, Ye & Guo, Bing & Zang, Wenqian & Ge, Dazhuan & Luo, Wei & Zhao, Huihui. (2020). Desertification detection model in Naiman Banner based on the albedo-modified soil adjusted vegetation index feature space using the Landsat8 OLI images. Geomatics, Natural Hazards and Risk. 11. 544-558. 10.1080/19475705.2020.1734100.\n\nWu, Z., Lei, S., Bian, Z. *et al.* Study of the desertification index based on the albedo-MSAVI feature space for semi-arid steppe region. *Environ Earth Sci* 78, 232 (2019). https://doi.org/10.1007/s12665-019-8111-9\n\nYang et al (2022\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"monokai.theme","output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","book":{"title":"CASA0025 Final Assessment","author":"MASH Potatoes - Desert Rose","date":"22/04/2024","chapters":["index.qmd"],"favicon":"images/circl-logo.png"},"theme":{"light":"cosmo","dark":"darkly"},"code-copy":true,"linkcolor":"#34a832","title":"Project Desert Rose - Identifying desertification risk areas in Niger"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
>>>>>>> Stashed changes
